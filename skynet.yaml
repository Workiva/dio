name: dio_quality_checks
description: Runs Dart analysis and unit tests
contact: 'Frontend Architecture / #support-frontend-architecture'

image: drydock-prod.workiva.net/workiva/dart2_base_image:1
size: medium
timeout: 300 # 5 minutes

artifacts:
  - /testing/artifacts

scripts:
  - merge_branch.sh master
  - cd dio
  - timeout 2m dart pub get
  - dart analyze
  - cd ..
  - chmod +x ./scripts/prepare_pinning_certs.sh
  - ./scripts/prepare_pinning_certs.sh
  - cd dio
  - dart test -p vm

---

name: json_annotation_quality_checks
description: Runs Dart analysis and unit tests
contact: 'Frontend Architecture / #support-frontend-architecture'

image: drydock-prod.workiva.net/workiva/dart2_base_image:1
size: medium
timeout: 300 # 5 minutes

artifacts:
  - /testing/artifacts

scripts:
  - merge_branch.sh master
  - cd json_annotation-3.1.1
  - timeout 2m dart pub get
  - cp pubspec.lock /testing/artifacts/
  - dart analyze
  - dart format --set-exit-if-changed .
  - |
    if [ -d ./test/ ]; then
      dart test -p vm
    else
      echo No tests to run.
    fi

---

name: json_serializable_and_json_annotation_integration
description: Runs Dart analysis and unit tests when pulling json_annotation into json_serializable
contact: 'Frontend Architecture / #support-frontend-architecture'

image: drydock-prod.workiva.net/workiva/dart2_base_image:1
size: medium
timeout: 300 # 5 minutes

artifacts:
  - /testing/artifacts

scripts:
  - merge_branch.sh master
  - cd json_serializable-3.5.2
  - |
    echo -e '\ndependency_overrides:\n  json_annotation_3_1_1:\n    path: ../json_annotation-3.1.1' >> pubspec.yaml
  - git diff pubspec.yaml
  - timeout 2m dart pub get
  - cp pubspec.lock /testing/artifacts/
  - dart analyze
  - dart format --set-exit-if-changed .
  - dart test -p vm

---

name: json_serializable_quality_checks
description: Runs Dart analysis and unit tests
contact: 'Frontend Architecture / #support-frontend-architecture'

image: drydock-prod.workiva.net/workiva/dart2_base_image:1
size: medium
timeout: 300 # 5 minutes

artifacts:
  - /testing/artifacts

scripts:
  - merge_branch.sh master
  - cd json_serializable-3.5.2
  - timeout 2m dart pub get
  - cp pubspec.lock /testing/artifacts/
  - dart analyze
  - dart format --set-exit-if-changed .
  - dart test -p vm
